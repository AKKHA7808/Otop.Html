{% extends "base.html" %}
{% block title %}ข้อมูลสินค้า OTOP{% endblock %}

{% block extra_css %}
<style>
  #otopTable th, #otopTable td { vertical-align: middle; }
</style>
{% endblock %}

{% block content %}
<h2 class="mb-4">ข้อมูลสินค้า OTOP ทั้งหมด</h2>
<form id="filterForm" class="row g-2 mb-3">
  <div class="col-md-4">
    <select id="provinceFilter" class="form-select" aria-label="เลือกจังหวัด">
      <option value="">-- จังหวัดทั้งหมด --</option>
      {% for p in provinces %}
        <option value="{{ p.name }}">{{ p.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-4">
    <select id="categoryFilter" class="form-select" aria-label="เลือกหมวดหมู่">
      <option value="">-- หมวดหมู่ทั้งหมด --</option>
      {% for c in categories %}
        <option value="{{ c }}">{{ c }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-4 d-flex align-items-center">
    <button type="button" id="resetFilters" class="btn btn-outline-secondary ms-md-2">รีเซ็ตตัวกรอง</button>
  </div>
</form>
<div class="table-responsive">
  <table id="otopTable" class="table table-striped table-bordered align-middle">
    <thead class="table-secondary">
      <tr>
        <th>ชื่อสินค้า</th>
        <th>จังหวัด</th>
        <th>หมวดหมู่</th>
        <th>เรตติ้ง <i class="bi bi-star-fill text-warning"></i></th>
      </tr>
    </thead>
    <tbody>
      {% for product in products %}
      <tr>
        <td>{{ product.name }}</td>
        <td>
          <a href="{% url 'province_detail' slug=product.province.slug %}">
            <i class="bi bi-geo-alt-fill text-primary"></i> {{ product.province.name }}
          </a>
        </td>
        <td>{{ product.category }}</td>
        <td>{{ product.rating|floatformat:1 }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="4" class="text-center text-muted">ไม่มีข้อมูลสินค้า</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

{% block extra_js %}
<!-- DataTables filter binding อยู่ใน static/otop_search_thailand/scripts.js -->
{% endblock %}
